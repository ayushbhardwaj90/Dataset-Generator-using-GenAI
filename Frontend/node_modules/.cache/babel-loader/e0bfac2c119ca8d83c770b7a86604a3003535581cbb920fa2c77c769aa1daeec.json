{"ast":null,"code":"import{createContext,useCallback,useContext,useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(null);export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[token,setToken]=useState(localStorage.getItem('access_token'));const[loading,setLoading]=useState(true);// Change this to the IP address of your backend server\nconst API_BASE_URL='http://localhost:8000';const fetchUser=useCallback(async authToken=>{if(!authToken){setUser(null);setLoading(false);return;}try{const response=await fetch(\"\".concat(API_BASE_URL,\"/me\"),{headers:{'Authorization':\"Bearer \".concat(authToken)}});if(response.ok){const userData=await response.json();setUser(userData);}else{console.error('Failed to fetch user:',response.statusText);logout();}}catch(error){console.error('Error fetching user:',error);logout();}finally{setLoading(false);}},[]);useEffect(()=>{fetchUser(token);},[token,fetchUser]);const login=(newToken,userData)=>{localStorage.setItem('access_token',newToken);setToken(newToken);setUser(userData);};const logout=()=>{localStorage.removeItem('access_token');setToken(null);setUser(null);window.location.reload();};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,token,loading,login,logout,API_BASE_URL},children:children});};export const useAuth=()=>useContext(AuthContext);","map":{"version":3,"names":["createContext","useCallback","useContext","useEffect","useState","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","token","setToken","localStorage","getItem","loading","setLoading","API_BASE_URL","fetchUser","authToken","response","fetch","concat","headers","ok","userData","json","console","error","statusText","logout","login","newToken","setItem","removeItem","window","location","reload","Provider","value","useAuth"],"sources":["/workspace/Frontend/src/context/AuthContext.js"],"sourcesContent":["import { createContext, useCallback, useContext, useEffect, useState } from 'react';\n\nconst AuthContext = createContext(null);\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(localStorage.getItem('access_token'));\n  const [loading, setLoading] = useState(true);\n\n  // Change this to the IP address of your backend server\n  const API_BASE_URL = 'http://localhost:8000';\n\n  const fetchUser = useCallback(async (authToken) => {\n    if (!authToken) {\n      setUser(null);\n      setLoading(false);\n      return;\n    }\n    try {\n      const response = await fetch(`${API_BASE_URL}/me`, {\n        headers: {\n          'Authorization': `Bearer ${authToken}`,\n        },\n      });\n      if (response.ok) {\n        const userData = await response.json();\n        setUser(userData);\n      } else {\n        console.error('Failed to fetch user:', response.statusText);\n        logout();\n      }\n    } catch (error) {\n      console.error('Error fetching user:', error);\n      logout();\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchUser(token);\n  }, [token, fetchUser]);\n\n  const login = (newToken, userData) => {\n    localStorage.setItem('access_token', newToken);\n    setToken(newToken);\n    setUser(userData);\n  };\n\n  const logout = () => {\n    localStorage.removeItem('access_token');\n    setToken(null);\n    setUser(null);\n    window.location.reload();\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, token, loading, login, logout, API_BASE_URL }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => useContext(AuthContext);"],"mappings":"AAAA,OAASA,aAAa,CAAEC,WAAW,CAAEC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEpF,KAAM,CAAAC,WAAW,cAAGP,aAAa,CAAC,IAAI,CAAC,CAEvC,MAAO,MAAM,CAAAQ,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGR,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACS,KAAK,CAAEC,QAAQ,CAAC,CAAGV,QAAQ,CAACW,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC,CAAC,CACxE,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGd,QAAQ,CAAC,IAAI,CAAC,CAE5C;AACA,KAAM,CAAAe,YAAY,CAAG,uBAAuB,CAE5C,KAAM,CAAAC,SAAS,CAAGnB,WAAW,CAAC,KAAO,CAAAoB,SAAS,EAAK,CACjD,GAAI,CAACA,SAAS,CAAE,CACdT,OAAO,CAAC,IAAI,CAAC,CACbM,UAAU,CAAC,KAAK,CAAC,CACjB,OACF,CACA,GAAI,CACF,KAAM,CAAAI,QAAQ,CAAG,KAAM,CAAAC,KAAK,IAAAC,MAAA,CAAIL,YAAY,QAAO,CACjDM,OAAO,CAAE,CACP,eAAe,WAAAD,MAAA,CAAYH,SAAS,CACtC,CACF,CAAC,CAAC,CACF,GAAIC,QAAQ,CAACI,EAAE,CAAE,CACf,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAL,QAAQ,CAACM,IAAI,CAAC,CAAC,CACtChB,OAAO,CAACe,QAAQ,CAAC,CACnB,CAAC,IAAM,CACLE,OAAO,CAACC,KAAK,CAAC,uBAAuB,CAAER,QAAQ,CAACS,UAAU,CAAC,CAC3DC,MAAM,CAAC,CAAC,CACV,CACF,CAAE,MAAOF,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC5CE,MAAM,CAAC,CAAC,CACV,CAAC,OAAS,CACRd,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAAE,EAAE,CAAC,CAENf,SAAS,CAAC,IAAM,CACdiB,SAAS,CAACP,KAAK,CAAC,CAClB,CAAC,CAAE,CAACA,KAAK,CAAEO,SAAS,CAAC,CAAC,CAEtB,KAAM,CAAAa,KAAK,CAAGA,CAACC,QAAQ,CAAEP,QAAQ,GAAK,CACpCZ,YAAY,CAACoB,OAAO,CAAC,cAAc,CAAED,QAAQ,CAAC,CAC9CpB,QAAQ,CAACoB,QAAQ,CAAC,CAClBtB,OAAO,CAACe,QAAQ,CAAC,CACnB,CAAC,CAED,KAAM,CAAAK,MAAM,CAAGA,CAAA,GAAM,CACnBjB,YAAY,CAACqB,UAAU,CAAC,cAAc,CAAC,CACvCtB,QAAQ,CAAC,IAAI,CAAC,CACdF,OAAO,CAAC,IAAI,CAAC,CACbyB,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAC1B,CAAC,CAED,mBACEjC,IAAA,CAACC,WAAW,CAACiC,QAAQ,EAACC,KAAK,CAAE,CAAE9B,IAAI,CAAEE,KAAK,CAAEI,OAAO,CAAEgB,KAAK,CAAED,MAAM,CAAEb,YAAa,CAAE,CAAAT,QAAA,CAChFA,QAAQ,CACW,CAAC,CAE3B,CAAC,CAED,MAAO,MAAM,CAAAgC,OAAO,CAAGA,CAAA,GAAMxC,UAAU,CAACK,WAAW,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}